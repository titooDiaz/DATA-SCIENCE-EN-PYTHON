<p align="center">
  <img width="150px" src="https://i.ibb.co/bXvzjXm/LOGO-h1.png" />
</p>

# Introducción a la Regresión Ridge  
Para modelos con múltiples características independientes y aquellos con extrapolación de características polinomiales, es común tener combinaciones colineales de características. Si no se controla, esta multicolinealidad de características puede llevar al modelo a sobreajustar los datos de entrenamiento. Para controlar esto, los conjuntos de características suelen regularizarse utilizando hiperparámetros.

La regresión Ridge es el proceso de regularización del conjunto de características utilizando el hiperparámetro alpha. El video que sigue muestra cómo la regresión Ridge puede ser utilizada para regularizar y reducir los errores estándar, evitando el sobreajuste al utilizar un modelo de regresión.

# Resumen:
Enhorabuena Ha completado esta lección. En este punto del curso, ya sabe

Cómo dividir sus datos utilizando el método train_test_split() en conjuntos de entrenamiento y de prueba. Cómo utilizar el conjunto de entrenamiento para entrenar un modelo, descubrir posibles relaciones predictivas y, a continuación, utilizar el conjunto de prueba para probar su modelo y evaluar su rendimiento.

Cómo utilizar el error de generalización para medir lo bien que lo hacen sus datos a la hora de predecir datos no vistos previamente.

Cómo utilizar la validación cruzada dividiendo los datos en pliegues en los que utiliza algunos de los pliegues como conjunto de entrenamiento, que utilizamos para entrenar el modelo, y las partes restantes se utilizan como conjunto de prueba, que utilizamos para probar el modelo. Se itera a través de los pliegues hasta que se utiliza cada partición para el entrenamiento y la prueba. Al final, promedia los resultados como estimación del error fuera de muestra.

Cómo elegir el mejor orden polinómico y problemas que surgen al seleccionar el orden polinómico incorrecto analizando los modelos que se ajustan por defecto y por exceso a sus datos.

Seleccione el mejor orden de un polinomio para ajustar sus datos minimizando el error de prueba mediante un gráfico que compare el error cuadrático medio con el orden de los polinomios ajustados.

Debe utilizar la regresión ridge cuando exista una fuerte relación entre las variables independientes.

La regresión ridge evita el sobreajuste.

La regresión ridge controla la magnitud de los coeficientes polinómicos introduciendo un hiperparámetro, alfa.

Para determinar alfa, se dividen los datos en datos de entrenamiento y datos de validación. Empezando con un valor pequeño para alfa, entrena el modelo, hace una predicción utilizando los datos de validación, luego calcula el R-cuadrado y guarda los valores. Repite el proceso para un valor mayor de alfa. Repite el proceso para diferentes valores de alfa, entrena el modelo y realiza una predicción. Usted selecciona el valor de alfa que maximiza R-cuadrado.

Esa búsqueda de cuadrícula le permite explorar múltiples hiperparámetros utilizando la biblioteca Scikit-learn, que itera sobre estos parámetros utilizando la validación cruzada. Basándose en los resultados del método de búsqueda en cuadrícula, selecciona los valores óptimos de los hiperparámetros.

El método GridSearchCV() toma como argumento un diccionario en el que la clave es el nombre del hiperparámetro y los valores son los valores de hiperparámetro sobre los que desea iterar.

# Comandos:
<table>
    <tbody><tr>
</tr><tr>
<th width="20%"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proceso</font></font></th><th width="30%"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripción</font></font></th><th width="50%"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejemplo de código</font></font></th>
</tr>
    <tr>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">División de datos para entrenamiento y pruebas</font></font></td>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El proceso implica primero separar el atributo de destino del resto de los datos. Trate el atributo de destino como la salida y el resto de los datos como la entrada. Ahora divida los conjuntos de datos de entrada y salida en subconjuntos de entrenamiento y prueba.</font></font></td>
        <td><pre class="prettyprint linenums prettyprinted" style=""><ol class="formatted-line-numbers"><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></li></ol><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">model_selection </span><span class="kwd">import</span><span class="pln"> train_test_split</span></code></li><li class="L1"><code><span class="pln">y_data </span><span class="pun">=</span><span class="pln"> df</span><span class="pun">[</span><span class="str">'target_attribute'</span><span class="pun">]</span></code></li><li class="L2"><code><span class="pln">x_data</span><span class="pun">=</span><span class="pln">df</span><span class="pun">.</span><span class="pln">drop</span><span class="pun">(</span><span class="str">'target_attribute'</span><span class="pun">,</span><span class="pln">axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">x_train</span><span class="pun">,</span><span class="pln"> x_test</span><span class="pun">,</span><span class="pln"> y_train</span><span class="pun">,</span><span class="pln"> y_test </span><span class="pun">=</span><span class="pln"> train_test_split</span><span class="pun">(</span><span class="pln">x_data</span><span class="pun">,</span><span class="pln"> y_data</span><span class="pun">,</span><span class="pln"> test_size</span><span class="pun">=</span><span class="lit">0.10</span><span class="pun">,</span><span class="pln"> random_state</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span></code></li></ol><button title="Copiar" class="action-code-block copy-code-block multiple-lines"><i class="fa fa-copy" aria-hidden="true"></i><span class="popuptext" id="md-code-block-copy-0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copiado!</font></font></span></button></pre></td>
    </tr>
    <tr>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puntuación de validación cruzada</font></font></td>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sin datos suficientes, se recurre a la validación cruzada, que implica crear diferentes subconjuntos de datos de entrenamiento y prueba varias veces y evaluar el rendimiento de todos ellos utilizando el </font><font style="vertical-align: inherit;">valor R </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 .</font></font></sup><font style="vertical-align: inherit;"></font></td>
        <td><pre class="prettyprint linenums prettyprinted" style=""><ol class="formatted-line-numbers"><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></li></ol><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">model_selection </span><span class="kwd">import</span><span class="pln"> cross_val_score</span></code></li><li class="L1"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">linear_model </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">LinearRegression</span><span class="pln"> </span></code></li><li class="L2"><code><span class="pln">lre</span><span class="pun">=</span><span class="typ">LinearRegression</span><span class="pun">()</span></code></li><li class="L3"><code><span class="typ">Rcross</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cross_val_score</span><span class="pun">(</span><span class="pln">lre</span><span class="pun">,</span><span class="pln">x_data</span><span class="pun">[[</span><span class="str">'attribute_1'</span><span class="pun">]],</span><span class="pln">y_data</span><span class="pun">,</span><span class="pln">cv</span><span class="pun">=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">  </span></code></li><li class="L4"><code><span class="com"># n indicates number of times, or folds, for which the cross validation is to be done</span></code></li><li class="L5"><code><span class="typ">Mean</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Rcross</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">()</span></code></li><li class="L6"><code><span class="typ">Std_dev</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Rcross</span><span class="pun">.</span><span class="pln">std</span><span class="pun">()</span></code></li></ol><button title="Copiar" class="action-code-block copy-code-block multiple-lines"><i class="fa fa-copy" aria-hidden="true"></i><span class="popuptext" id="md-code-block-copy-1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copiado!</font></font></span></button></pre></td>
    </tr>
    <tr>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Predicción de validación cruzada</font></font></td>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilice un modelo validado de forma cruzada para crear una predicción del resultado.</font></font></td>
        <td><pre class="prettyprint linenums prettyprinted" style=""><ol class="formatted-line-numbers"><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></li></ol><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">model_selection </span><span class="kwd">import</span><span class="pln"> cross_val_predict</span></code></li><li class="L1"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">linear_model </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">LinearRegression</span><span class="pln"> </span></code></li><li class="L2"><code><span class="pln">lre</span><span class="pun">=</span><span class="typ">LinearRegression</span><span class="pun">()</span></code></li><li class="L3"><code><span class="pln">yhat </span><span class="pun">=</span><span class="pln"> cross_val_predict</span><span class="pun">(</span><span class="pln">lre</span><span class="pun">,</span><span class="pln">x_data</span><span class="pun">[[</span><span class="str">'attribute_1'</span><span class="pun">]],</span><span class="pln"> y_data</span><span class="pun">,</span><span class="pln">cv</span><span class="pun">=</span><span class="lit">4</span><span class="pun">)</span></code></li></ol><button title="Copiar" class="action-code-block copy-code-block multiple-lines"><i class="fa fa-copy" aria-hidden="true"></i><span class="popuptext" id="md-code-block-copy-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copiado!</font></font></span></button></pre></td>
    </tr>
    <tr>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regresión y predicción de crestas</font></font></td>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para crear un modelo de regresión polinomial que se ajuste mejor, como , uno que evite el sobreajuste a los datos de entrenamiento, utilizamos el modelo de regresión Ridge con un parámetro alfa que se utiliza para modificar el efecto de los parámetros de orden superior en la predicción del modelo.</font></font></td>
        <td><pre class="prettyprint linenums prettyprinted" style=""><ol class="formatted-line-numbers"><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></li></ol><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">linear_model </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Ridge</span></code></li><li class="L1"><code><span class="pln">pr</span><span class="pun">=</span><span class="typ">PolynomialFeatures</span><span class="pun">(</span><span class="pln">degree</span><span class="pun">=</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> x_train_pr</span><span class="pun">=</span><span class="pln">pr</span><span class="pun">.</span><span class="pln">fit_transform</span><span class="pun">(</span><span class="pln">x_train</span><span class="pun">[[</span><span class="str">'attribute_1'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'attribute_2'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...]])</span></code></li><li class="L2"><code><span class="pln">x_test_pr</span><span class="pun">=</span><span class="pln">pr</span><span class="pun">.</span><span class="pln">fit_transform</span><span class="pun">(</span><span class="pln">x_test</span><span class="pun">[[</span><span class="str">'attribute_1'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'attribute_2'</span><span class="pun">,...]])</span></code></li><li class="L3"><code><span class="typ">RigeModel</span><span class="pun">=</span><span class="typ">Ridge</span><span class="pun">(</span><span class="pln">alpha</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L4"><code><span class="typ">RigeModel</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">x_train_pr</span><span class="pun">,</span><span class="pln"> y_train</span><span class="pun">)</span></code></li><li class="L5"><code><span class="pln">yhat </span><span class="pun">=</span><span class="pln"> </span><span class="typ">RigeModel</span><span class="pun">.</span><span class="pln">predict</span><span class="pun">(</span><span class="pln">x_test_pr</span><span class="pun">)</span></code></li></ol><button title="Copiar" class="action-code-block copy-code-block multiple-lines"><i class="fa fa-copy" aria-hidden="true"></i><span class="popuptext" id="md-code-block-copy-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copiado!</font></font></span></button></pre></td>
    </tr>
    <tr>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Búsqueda en cuadrícula</font></font></td>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilice la búsqueda en cuadrícula para encontrar el valor alfa correcto para el cual el modelo de regresión Ridge ofrece el mejor rendimiento. Además, utiliza la validación cruzada para crear un modelo más refinado.</font></font></td>
        <td><pre class="prettyprint linenums prettyprinted" style=""><ol class="formatted-line-numbers"><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></li></ol><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">model_selection </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">GridSearchCV</span></code></li><li class="L1"><code><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">linear_model </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Ridge</span></code></li><li class="L2"><code><span class="pln">parameters</span><span class="pun">=</span><span class="pln"> </span><span class="pun">[{</span><span class="str">'alpha'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0.001</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">,</span><span class="pln"> </span><span class="lit">100</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10000</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...]}]</span></code></li><li class="L3"><code><span class="pln">RR</span><span class="pun">=</span><span class="typ">Ridge</span><span class="pun">()</span></code></li><li class="L4"><code><span class="typ">Grid1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GridSearchCV</span><span class="pun">(</span><span class="pln">RR</span><span class="pun">,</span><span class="pln"> parameters1</span><span class="pun">,</span><span class="pln">cv</span><span class="pun">=</span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Grid1</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">x_data</span><span class="pun">[[</span><span class="str">'attribute_1'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'attribute_2'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...]],</span><span class="pln"> y_data</span><span class="pun">)</span></code></li><li class="L5"><code><span class="typ">BestRR</span><span class="pun">=</span><span class="typ">Grid1</span><span class="pun">.</span><span class="pln">best_estimator_</span></code></li><li class="L6"><code><span class="typ">BestRR</span><span class="pun">.</span><span class="pln">score</span><span class="pun">(</span><span class="pln">x_test</span><span class="pun">[[</span><span class="str">'attribute_1'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'attribute_2'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...]],</span><span class="pln"> y_test</span><span class="pun">)</span></code></li></ol><button title="Copiar" class="action-code-block copy-code-block multiple-lines"><i class="fa fa-copy" aria-hidden="true"></i><span class="popuptext" id="md-code-block-copy-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copiado!</font></font></span></button></pre></td>
    </tr>
</tbody></table>